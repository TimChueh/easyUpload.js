(()=>{var e={893:(e,s,t)=>{!function(e,s){var t={accept:".jpg,.png,.pdf,.doc,.docx",btnS:"导入文件",btnU:"上传",btnD:"删除",btnC:"终止",maxCount:3,naxSize:3,multiple:!0,responseType:"text",timeout:0,url:"",withCredentials:!0,readAs:"DataURL"};function i(){var e=['<div class="easy-upload">','   <div class="btns">','       <input type="file" name="file" class="file-inpt" accept="'+this.conf.accept+'"'+(this.conf.multiple?" multiple ":"")+' style="display: none;">','       <input type="button" value="'+this.conf.btnS+'" class="select pointer">','       <input type="button" value="'+this.conf.btnU+'" class="upload no-border radius pointer white bg-blue">','       <input type="button" value="'+this.conf.btnD+'" class="delete no-border radius pointer white bg-red">','       <input type="button" value="'+this.conf.btnC+'" class="cancel no-border radius pointer white bg-red">','       <input type="checkbox" class="checall pointer">','       <i class="msg new">未导入文件</i>',"   </div>",'   <ul class="file-list">',"   </ul>","</div>"];this.eNode.innerHTML=e.join(""),l.call(this,(function(e){e.fNode.onchange=function(){a.call(e,this.files),n.call(e),d.call(e)}}))}function n(){var e=[];for(var s in this.files)if(null!==this.files[s]){var t=['<li class="file-li over-hidden radius">','   <div class="info">','       <p class="over-hidden '+u(this.files[s].status)+'">','           <span class="name-size">','               <i class="f-size white radius '+u(this.files[s].status,1)+'">'+this.files[s].size+"</i>",'               <i class="f-name">'+this.files[s].name+"</i>","           </span>",'           <span class="tips">','               <i class="status">'+f(this.files[s].status)+"</i>",'               <i class="percent">'+this.files[s].percent+"</i>","           </span>","       </p>",'       <div class="wrap over-hidden radius">','           <div class="progress '+u(this.files[s].status,1)+'" style="width:'+this.files[s].percent+';"></div>',"       </div>","   </div>",'   <div class="pic-box">','       <i class="pic no-selec'+(/data:image\//.test(this.files[s].data)?'" style="background-image: url('+this.files[s].data+');"':' icon"')+"></i>","   </div>",'   <div class="li-btns over-hidden">','       <input type="checkbox" '+(this.files[s].checked?"checked":"")+' data-id="'+s+'" class="checone pointer">','       <i data-id="'+s+'" class="deleone no-selec pointer white"></i>',"   </div>","</li>"];e.push(t.join(""))}this.lNode.innerHTML=e.join("")}function l(e){var s=this,t=null;t=setTimeout((function(){e(s),clearTimeout(t)}),0)}function a(e){var s=this,t=[],i={};if(e.length>this.conf.maxCount){this.onMax&&this.onMax.call(s,{in:e.length,max:this.conf.maxCount});for(var l=0;l<this.conf.maxCount;l++)t.push(e[l])}else t=e;for(l=0;l<t.length;l++){i[l]=new FileReader,i[l].i=l,i[l].o={id:this.id,name:t[l].name,type:t[l].type,size:x(t[l].size),checked:!1,percent:"0%",status:v.call(this,t[l].size),source:t[l],data:""},i[l].id=this.id,this.id++,i[l].onload=function(e){this.o.data=e.target.result,s.files[this.id]=this.o,n.call(s),d.call(s),this.i==t.length-1&&(i=null,s.fNode.value="")};var a=this.conf.readAs;i[l]["readAs"+a]?i[l]["readAs"+a](t[l]):i[l].readAsDataURL(t[l])}}function o(){var e=this;for(var s in this.xhrs.on=0,this.xhrs.done=0,this.files)null!==this.files[s]&&this.files[s].checked&&"-2"!==this.files[s].status&&(this.xhrs[s]=new XMLHttpRequest,this.xhrs[s].id=this.files[s].id,this.xhrs[s].open("post",this.conf.url),this.xhrs[s].timeout=this.conf.timeout,this.xhrs[s].responseType=this.conf.responseType,this.xhrs[s].withCredentials=this.conf.withCredentials,e.setHeader&&e.setHeader.call(e,this.xhrs[s]),this.xhrs[s].send(this.setData?this.setData.call(this,this.files[s]):this.files[s].data),this.xhrs.on++,this.files[s].status="1",this.files[s].percent="0%",n.call(this),this.xhrs[s].onprogress=function(s){if(s.lengthComputable){var t=s.loaded/s.total*100+"%";e.files[this.id].status="1",e.files[this.id].percent=t,n.call(e),e.onProgress&&e.onProgress.call(e,t)}},this.xhrs[s].onload=function(){e.xhrs.done++;var s=e.setFlag&&e.setFlag.call(e,this);(null==s?this.status>=200&&this.status<300:s)?e.files[this.id].status="2":e.files[this.id].status="-1",n.call(e),e.onLoad&&e.onLoad.call(e,this),e.xhrs.on==e.xhrs.done&&(p.call(e,"上传结束"),e.onEnd&&e.onEnd.call(e,this),e.xhrs={})},this.xhrs[s].onerror=function(){e.xhrs.done++,e.files[this.id].status="-1",n.call(e),e.xhrs.on==e.xhrs.done+1?(p.call(e,"上传结束"),e.onEnd&&e.onEnd.call(e,this),e.xhrs={}):e.onError&&e.onError.call(e,this)})}function c(e,s){if(e){var t=s.getAttribute("data-id");this.files[t]=null}else for(var i in this.files)null!==this.files[i]&&this.files[i].checked&&(this.files[i]=null);n.call(this),d.call(this)}function r(){var e=this;for(var s in this.xhrs)this.xhrs[s]&&(this.xhrs[s].onabort=function(){p.call(e,"成功终止")},this.xhrs[s].abort())}function h(e,s){if(e)d.call(this,s);else{for(var t in this.files)null!==this.files[t]&&(this.files[t].checked=s.checked);for(var i=this.eNode.querySelectorAll(".checone"),n=0;n<i.length;n++)i[n].checked=s.checked;p.call(this,s.checked?"已选中":"未选中")}}function d(e){var s=!1,t=!0,i=this.eNode.querySelector(".checall");if(e){var n=e.getAttribute("data-id");this.files[n].checked=e.checked}for(var l in this.files)null!==this.files[l]&&(this.files[l].checked?s=!0:t=!1);i.checked=t,p.call(this,s?"已选中":"未选中")}function u(e,s){switch(s=s?"bg-":"",e){case"-2":return s+"yellow";case"-1":return s+"red";case"0":return s+"blue";case"1":case"2":return s+"green"}}function f(e){switch(e){case"-2":return"文件过大";case"-1":return"上传失败";case"0":return"允许上传";case"1":return"正在上传";case"2":return"上传成功"}}function p(e){this.eNode.querySelector(".msg").innerText=e||"操作成功"}function x(e){if(0===e)return"0 B";var s=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,s)).toPrecision(3)+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][s]}function v(e){var s=(e/Math.pow(1024,2)).toFixed(2);return this.conf.naxSize>=s?"0":"-2"}e.EasyUpload=function(e,n){if(this.eNode=s.querySelector(e),this.eNode){var l=this;l.files={},l.xhrs={},l.id=0,this.conf=function(e){if(null!==e&&"object"==typeof e)for(var s in e)null!=t[s]&&(t[s]=e[s]);return t}(n),i.call(l),this.fNode=this.eNode.querySelector(".file-inpt"),this.lNode=this.eNode.querySelector(".file-list"),this.eNode.onclick=function(e){var s=e.target;-1!==s.className.indexOf("select")?l.fNode.click():-1!==s.className.indexOf("upload")?o.call(l):-1!==s.className.indexOf("delete")?c.call(l,0,s):-1!==s.className.indexOf("cancel")?r.call(l):-1!==s.className.indexOf("checall")?h.call(l,0,s):-1!==s.className.indexOf("checone")?h.call(l,1,s):-1!==s.className.indexOf("deleone")&&c.call(l,1,s)}}else alert("插件初始化id错误")}}(e=t.nmd(e),document)}},s={};function t(i){var n=s[i];if(void 0!==n)return n.exports;var l=s[i]={id:i,loaded:!1,exports:{}};return e[i](l,l.exports,t),l.loaded=!0,l.exports}t.n=e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return t.d(s,{a:s}),s},t.d=(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},t.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),t.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";t(893);const e=new EasyUpload("#easy1",{url:"https://jsonplaceholder.typicode.com/posts/",naxSize:5,maxCount:3});e.onMax=function(e){console.log("in:"+e.in,"max:"+e.max)},e.setHeader=function(e){},e.setData=function(e){return"abcdefg"},e.setFlag=function(){},e.onProgress=function(e){console.log("上传中",e)},e.onLoad=function(e){console.log("上传完一个",e)},e.onError=function(e){console.log("上传失败一个",e)},e.onEnd=function(){console.log("上传完成",this)},new EasyUpload("#easy2")})()})();